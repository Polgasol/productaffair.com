(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{57270:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/upload",function(){return t(41596)}])},41596:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ee}});var r=t(85893),a=t(67294),o=t(86750),i=t.n(o),s=t(34051),c=t.n(s),l=t(55162),u=t(15147),d=t(9903),p=t(15568),m=t(83321),h=t(23599),f=t(56815),v=t(94054),g=t(47742),x=t(74231),j=t(95496),y=t(87536),b=t(9669),w=t.n(b);function _(e,n,t,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void t(l)}s.done?n(c):Promise.resolve(c).then(r,a)}function S(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var o=e.apply(n,t);function i(e){_(o,r,a,i,s,"next",e)}function s(e){_(o,r,a,i,s,"throw",e)}i(void 0)}))}}var U=function(){var e=S(c().mark((function e(){var n,t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=5;break;case 3:return n=e.sent,e.abrupt("return",n.data.data);case 5:return e.next=7,w().get("https://api.productaffair.com/api/upload",{withCredentials:!0});case 7:return t=e.sent,e.abrupt("return",t.data.data);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=S(c().mark((function e(n){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=5;break;case 3:return t=e.sent,e.abrupt("return",t.data.data);case 5:return e.next=7,w().post("https://api.productaffair.com/api/upload",n,{withCredentials:!0});case 7:return r=e.sent,e.abrupt("return",r.data.data);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),N=t(9581),C=t(31425),k=t(83913),P=t(67141),I=t(40221);function A(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function z(e,n,t,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void t(l)}s.done?n(c):Promise.resolve(c).then(r,a)}function O(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return A(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return A(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var F=function(e){var n,t=e.files,o=e.setFiles,i=e.setCroppedImage,s=e.setUploadErr,l=e.croppedImage,u=(0,a.useState)({x:0,y:0}),d=u[0],p=u[1],h=(0,a.useState)(1),f=h[0],v=h[1],g=(0,a.useState)(0),x=g[0],j=g[1],y=(0,a.useState)(null),b=y[0],w=y[1],_=function(){var e,n=(e=c().mark((function e(){var n,r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,P.ZP)(t[0].preview,b,x);case 3:return n=e.sent.file,r={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0},e.next=7,(0,I.Z)(n,r);case 7:a=e.sent,i((function(e){return e.length<5&&s(""),e.length>=5&&s("Sobra kana boy..."),e.length>4?O(e):O(e).concat([a])}),[l.length]),o([]),w(b),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(0);case 15:case"end":return e.stop()}}),e,null,[[0,13]])})),function(){var n=this,t=arguments;return new Promise((function(r,a){var o=e.apply(n,t);function i(e){z(o,r,a,i,s,"next",e)}function s(e){z(o,r,a,i,s,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(N.Z,{sx:{background:"hsl(206.1, 9%, 50%)",position:"relative",height:350,width:350,aspectRatio:"1 / 1",minWidth:"350px",overflow:"auto"},dividers:!0,children:(0,r.jsx)(k.ZP,{image:null===(n=t[0])||void 0===n?void 0:n.preview,crop:d,zoom:f,rotation:x,onCropChange:p,onZoomChange:v,onRotationChange:j,aspect:1,onCropComplete:function(e,n){return w(n)}})}),(0,r.jsxs)(C.Z,{sx:{flexDirection:"row",mx:3,my:2,justifyContent:"center",alignItems:"center"},children:[(0,r.jsx)(m.Z,{variant:"outlined",onClick:function(){o([])},children:"Cancel"}),(0,r.jsx)(m.Z,{variant:"contained",onClick:_,style:{backgroundColor:"var(--blue)",color:"var(--white)"},children:"Add"})]})]})},D=t(30824),E=t.n(D),L=t(3471),M=t(11163),T=t(31812);function R(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function H(e,n,t,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void t(l)}s.done?n(c):Promise.resolve(c).then(r,a)}function W(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var o=e.apply(n,t);function i(e){H(o,r,a,i,s,"next",e)}function s(e){H(o,r,a,i,s,"throw",e)}i(void 0)}))}}function q(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function B(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){q(e,n,t[n])}))}return e}function G(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return R(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return R(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var X=function(){var e=(0,L.useQueryClient)(),n=(0,M.useRouter)(),t=(0,L.useMutation)({mutationFn:function(e){return Z(e)},onSuccess:function(t){e.invalidateQueries({queryKey:["getProfilePosts",t.userId]}),n.push("/profile/".concat(t.userId))}}),o=(t.data,t.mutate),i=t.isLoading,s=t.isError,b=x.Ry().shape({title:x.Z_().min(1).max(100).required().defined(),storeName:x.Z_().min(1).max(100).required().defined(),category:x.Z_().required().defined()}).defined(),w=(0,a.useState)([{id:0,label:"Quality",score:5},{id:1,label:"Price",score:5},{id:2,label:"Customer Service",score:5}]),_=w[0],S=w[1],U=(0,y.cI)({mode:"onChange",resolver:(0,j.X)(b)}),N=U.register,C=U.handleSubmit,k=(U.formState.errors,(0,a.useState)("")),P=k[0],I=k[1],A=(0,a.useState)(!1),z=(A[0],A[1]),O=(0,a.useState)([]),D=O[0],R=O[1],H=(0,a.useState)(""),q=H[0],X=H[1],K=(0,a.useState)([]),Q=K[0],J=K[1],V=(0,a.useCallback)((function(e,n){var t=e.map((function(e){return{preview:URL.createObjectURL(e),file:e}}));if(0===t.length)return n.forEach((function(e){e.errors.forEach((function(e){switch(e.code){case"file-too-large":return X("File is too large.");case"file-invalid-type":return X("Invalid file type.");case"too-many-files":return X("Upload 1 image at a time.");default:return null}}))}));R((function(e){return e.length<5&&0===n.length&&X(""),e.length>=5&&X("Sobra kana boy..."),e.length>4?G(e):G(t)}))}),[D.length]),Y=(0,l.uI)({onDrop:V,maxFiles:1,maxSize:1e7,accept:{"image/jpeg":[".jpeg"],"image/jpg":[".jpg"],"image/png":[".png"],"image/webp":[".webp"]},noKeyboard:!0}),$=Y.getRootProps,ee=Y.getInputProps,ne=function(){var e=W(c().mark((function e(n){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new FormData,0!==Q.length){e.next=5;break}X("Upload an image..."),e.next=12;break;case 5:for(t.append("title",n.title),t.append("storeName",n.storeName),t.append("category",n.category),t.append("ratings",JSON.stringify(_)),r=0;r<Q.length;r++)t.append("image",Q[r],"crppfile.jpeg");return e.next=12,o(t);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),te=C(function(){var e=W(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Q.length){e.next=4;break}X("Upload an image..."),e.next=6;break;case 4:return e.next=6,ne(n);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),(function(e){z(!0)}));return(0,r.jsxs)("form",{className:E()["upload-con"],onSubmit:te,encType:"multipart/formdata",children:[(0,r.jsx)(F,{files:D,setFiles:R,setCroppedImage:J,setUploadErr:X,croppedImage:Q}),(0,r.jsxs)("div",{className:E()["upload-preview-con"],children:[(0,r.jsxs)("div",B({className:E()["dropzone-con"]},$(),{children:[(0,r.jsx)(u.Z,{sx:{fontSize:"2rem",color:"#90ADB0"}}),(0,r.jsx)("input",B({type:"file",className:E()["dropzone-input"]},ee())),(0,r.jsx)("span",{className:E()["dropzone-text"],children:"Upload"})]})),(0,r.jsx)("div",{className:E()["small-preview-con"],children:(null===Q||void 0===Q?void 0:Q.length)>0&&(null===Q||void 0===Q?void 0:Q.map((function(e,n){var t=URL.createObjectURL(e);return(0,r.jsxs)("div",{className:E()["remove-small-preview"],children:[(0,r.jsx)("div",{className:E()["preview-con"],children:(0,r.jsx)("div",{className:E()["img-preview-con"],children:(0,r.jsx)("img",{src:t,className:E()["img-preview"],alt:"img"},t)},n)}),(0,r.jsx)("div",{className:E()["remove-btn-con"],children:(0,r.jsx)(d.Z,{onClick:function(){return function(e,n){J((function(n){return n.filter((function(n){return n!==e}))})),X("")}(e)},sx:{fontSize:"1rem",color:"var(--blue)",cursor:"pointer"}})})]},n)})))})]}),q?(0,r.jsx)(p.Z,{severity:"error",children:(0,r.jsx)("strong",{children:q})}):null,(0,r.jsxs)("div",{className:E()["bottom-upload-con"],children:[(0,r.jsxs)("div",{className:E()["title-con"],children:[(0,r.jsx)("span",{className:E()["title-text"],children:"Title"}),(0,r.jsx)("input",B({className:E()["title-input"],type:"text"},N("title")))]}),(0,r.jsxs)("div",{className:E()["store-name-con"],children:[(0,r.jsx)("span",{className:E()["store-name-text"],children:"Store name"}),(0,r.jsx)("input",B({className:E()["store-name-input"],type:"text"},N("storeName")))]}),(0,r.jsxs)("div",{className:E()["ratings-bot-con"],children:[(0,r.jsx)("div",{className:E()["ratings-list-con"],children:_.map((function(e,n){var t=e.id,a=e.label;return(0,r.jsxs)("div",{className:E()["ratings-row-con"],children:[(0,r.jsx)("div",{className:E()["ratings-title-con"],children:(0,r.jsx)("span",{className:E()["ratings-title-text"],children:a})}),(0,r.jsxs)("div",{className:E()["score-con"],children:[(0,r.jsxs)("span",{className:E()["score-text"],children:["( ",_[n].score.toFixed(1)," )"]}),(0,r.jsx)(m.Z,{size:"small",variant:"contained",type:"button",sx:{fontSize:"1rem",padding:0,marginLeft:"1rem",backgroundColor:"var(--blue)",color:"var(--white)"},onClick:function(){return e=n,void S((function(n){return n[e].score>5||n[e].score>1?(n[e].score-=1,G(n)):G(n)}));var e},children:"-"}),(0,r.jsx)(m.Z,{size:"small",variant:"contained",type:"button",sx:{fontSize:"1rem",padding:0,marginLeft:"0.5rem",backgroundColor:"var(--blue)",color:"var(--white)"},onClick:function(){return e=n,void S((function(n){return n[e].score<5||n[e].score<1?(n[e].score+=1,G(n)):G(n)}));var e},children:"+"})]})]},t)}))}),(0,r.jsxs)(v.Z,{sx:{m:1,minWidth:"100%",size:"small"},children:[(0,r.jsx)(f.Z,{children:"Choose one category"}),(0,r.jsxs)(g.Z,B({},N("category"),{value:P,onChange:function(e){return n=e.target.value,void I(n);var n},displayEmpty:!0,inputProps:{"aria-label":"choose 1 category"},MenuProps:{PaperProps:{sx:{maxHeight:200}}},sx:{height:"3rem",margin:"0 0 5rem 0"},children:[(0,r.jsx)(h.Z,{value:"",children:(0,r.jsx)("em",{children:"-Categories-"})}),(0,r.jsx)(h.Z,{value:"Technology",children:"Technology"}),(0,r.jsx)(h.Z,{value:"Health and Wellness",children:"Health and Wellness"}),(0,r.jsx)(h.Z,{value:"Men's Clothing",children:"Men's Clothing"}),(0,r.jsx)(h.Z,{value:"Women's Clothing",children:"Women's Clothing"}),(0,r.jsx)(h.Z,{value:"Unique Items",children:"Unique Items"}),(0,r.jsx)(h.Z,{value:"Travel",children:"Travel"}),(0,r.jsx)(h.Z,{value:"Food and Drinks",children:"Food and Drinks"}),(0,r.jsx)(h.Z,{value:"Kitchen",children:"Kitchen"}),(0,r.jsx)(h.Z,{value:"Home Improvement",children:"Home Improvement"}),(0,r.jsx)(h.Z,{value:"Sports and Recreation",children:"Sports and Recreation"}),(0,r.jsx)(h.Z,{value:"Nature",children:"Nature"}),(0,r.jsx)(h.Z,{value:"Skin Care",children:"Skin Care"}),(0,r.jsx)(h.Z,{value:"Baby",children:"Baby"}),(0,r.jsx)(h.Z,{value:"Toys and Gaming",children:"Toys and Gaming"}),(0,r.jsx)(h.Z,{value:"Art and Design",children:"Art and Design"}),(0,r.jsx)(h.Z,{value:"Pets",children:"Pets"}),(0,r.jsx)(h.Z,{value:"Vehicle and Motors",children:"Vehicle and Motors"})]}))]}),(0,r.jsx)("div",{className:E()["upload-btn-con"],children:i?(0,r.jsx)(T.Z,{loading:!0}):(0,r.jsx)(m.Z,{sx:{backgroundColor:"var(--blue)",color:"var(--white)"},size:"large",variant:"contained",type:"submit",children:"Upload"})}),(0,r.jsx)("div",{className:E()["error-con"],children:s?(0,r.jsx)("div",{children:"An error occurred"}):(0,r.jsx)(r.Fragment,{})})]})]})]})},K=t(98456),Q=function(){var e,n=(0,M.useRouter)(),t=(0,L.useQuery)(["getUpload"],U),a=t.data,o=t.isLoading,s=t.isError,c=null===a||void 0===a||null===(e=a.auth)||void 0===e?void 0:e.verified;return o?(0,r.jsx)("div",{className:i()["loading-container"],children:(0,r.jsx)(K.Z,{})}):(s&&n.push("/404"),!1===c&&n.push("/"),(0,r.jsx)("main",{className:i()["upload-main"],children:(0,r.jsx)("div",{className:i()["upload-section-con"],children:(0,r.jsx)(X,{})})}))},J=t(9008),V=t.n(J),Y=t(4298),$=t.n(Y),ee=function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(V(),{children:[(0,r.jsx)("meta",{name:"description",content:""}),(0,r.jsx)("meta",{content:"width=device-width,maximum-scale=1.0,initial-scale=1.0,minimum-scale=0.9,user-scalable=no",name:"viewport"}),(0,r.jsx)("meta",{name:"format-detection",content:"telephone=no"}),(0,r.jsx)("meta",{name:"google",content:"notranslate"}),(0,r.jsx)("meta",{name:"application-name",content:"Productaffair"}),(0,r.jsx)("meta",{property:"og:site_name",content:"Productaffair"}),(0,r.jsx)("meta",{property:"og:locale",content:"en_US"})]}),(0,r.jsx)($(),{src:"https://www.googletagmanager.com/gtag/js?id=G-2FJZ116LFW",strategy:"afterInteractive"}),(0,r.jsx)($(),{id:"google-analytics",strategy:"afterInteractive",children:"window.dataLayer = window.dataLayer || [];\n  function gtag(){dataLayer.push(arguments);}\n  gtag('js', new Date());\n\n  gtag('config', 'G-2FJZ116LFW');"})]}),(0,r.jsx)(Q,{})]})}},67141:function(e,n,t){"use strict";t.d(n,{ZP:function(){return u}});var r=t(34051),a=t.n(r);function o(e,n,t,r,a,o,i){try{var s=e[o](i),c=s.value}catch(l){return void t(l)}s.done?n(c):Promise.resolve(c).then(r,a)}function i(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function s(e){o(i,r,a,s,c,"next",e)}function c(e){o(i,r,a,s,c,"throw",e)}s(void 0)}))}}var s=function(e){return new Promise((function(n,t){var r=new Image;r.addEventListener("load",(function(){return n(r)})),r.addEventListener("error",(function(e){return t(e)})),r.setAttribute("crossOrigin","anonymous"),r.src=e}))};function c(e){return e*Math.PI/180}function l(e,n,t){var r=c(t);return{width:Math.abs(Math.cos(r)*e)+Math.abs(Math.sin(r)*n),height:Math.abs(Math.sin(r)*e)+Math.abs(Math.cos(r)*n)}}function u(e,n){return d.apply(this,arguments)}function d(){return d=i(a().mark((function e(n,t){var r,o,i,u,d,p,m,h,f,v,g=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g.length>2&&void 0!==g[2]?g[2]:0,o=g.length>3&&void 0!==g[3]?g[3]:{horizontal:!1,vertical:!1},e.next=3,s(n);case 3:if(i=e.sent,u=document.createElement("canvas"),d=u.getContext("2d")){e.next=8;break}return e.abrupt("return",null);case 8:return p=c(r),m=l(i.width,i.height,r),h=m.width,f=m.height,u.width=h,u.height=f,d.translate(h/2,f/2),d.rotate(p),d.scale(o.horizontal?-1:1,o.vertical?-1:1),d.translate(-i.width/2,-i.height/2),d.drawImage(i,0,0),v=d.getImageData(t.x,t.y,t.width,t.height),u.width=t.width,u.height=t.height,d.putImageData(v,0,0),e.abrupt("return",new Promise((function(e,n){u.toBlob((function(n){e({file:n,url:URL.createObjectURL(n)})}),"image/jpeg")})));case 22:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}},86750:function(e){e.exports={"loading-container":"UploadTemplate_loading-container__48kHD","upload-main":"UploadTemplate_upload-main__sv1m1","upload-section-con":"UploadTemplate_upload-section-con__YCuv0"}},30824:function(e){e.exports={"ratings-bot-con":"Upload_ratings-bot-con__Cgq4D","ratings-list-con":"Upload_ratings-list-con__SrXyi","ratings-row-con":"Upload_ratings-row-con__5w8ki","score-con":"Upload_score-con__CBtzB","score-text":"Upload_score-text__NaSDN","ratings-title-text":"Upload_ratings-title-text__SDHou","upload-btn-con":"Upload_upload-btn-con__HX4Ji","error-con":"Upload_error-con__jZDf9","store-name-con":"Upload_store-name-con__DOxUA","store-name-input":"Upload_store-name-input__6lcS4","title-con":"Upload_title-con__tPlB0","title-input":"Upload_title-input__n1572","bottom-upload-con":"Upload_bottom-upload-con__UxwhG","upload-preview-con":"Upload_upload-preview-con__Gkynb","dropzone-con":"Upload_dropzone-con__zmHny","dropzone-text":"Upload_dropzone-text__FeK16","img-preview-con":"Upload_img-preview-con__Q71O5","img-preview":"Upload_img-preview__P0Lff","preview-con":"Upload_preview-con__b8wX1","small-preview-con":"Upload_small-preview-con__uDSNt","upload-con":"Upload_upload-con__x8FaA","large-preview-con":"Upload_large-preview-con__AaHE5","remove-small-preview":"Upload_remove-small-preview__LZjYq","remove-btn-con":"Upload_remove-btn-con__ZbSiF"}}},function(e){e.O(0,[796,420,651,774,888,179],(function(){return n=57270,e(e.s=n);var n}));var n=e.O();_N_E=n}]);